{% extends 'shared/base.html' %}
{% load static %}
{% block content %}

<div class="upload-grid">
    
    <section class="upload-form-card">
        <h2>Enviar Novo Código</h2>
        <form action="{% url 'enviar_codigo' user.id %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="{{ form.arquivo.id_for_label }}">Arquivo do Bot (.m)</label>
                
                <label for="{{ form.arquivo.id_for_label }}" class="file-upload-label">
                    <span>Escolher arquivo</span>
                </label>
                <input 
                    type="file" 
                    name="{{ form.arquivo.name }}" 
                    id="{{ form.arquivo.id_for_label }}"
                    class="file-upload-input"
                    onchange="document.querySelector('.file-upload-label span').textContent = this.files[0] ? this.files[0].name : 'Escolher arquivo';"
                    required
                >
            </div>

            <button type="submit" class="btn btn-primary" style="margin-top: 1.5rem; width: 100%;">Enviar</button>
        </form>
    </section>

    <section class="active-code-card">
        <h2>Seu Código Ativo</h2>
        {% if cards %}
            {% for codigo in cards %}
                <div class="active-code-info">
                    <img src="{% static 'assets/imagens/matlab-logo.png' %}" alt="Código MATLAB">
                    <p>{{ codigo.arquivo }}</p>
                    <a href="{% url 'lista_codigos' codigo.id %}" class="btn btn-secondary" style="width: 100%; margin-top: 1rem;">Ver Detalhes</a>
                </div>
            {% endfor %}
        {% else %}
            <div class="no-active-code">
                <p>Você ainda não tem um código ativo.</p>
                <p>Envie seu primeiro bot para começar a competir!</p>
            </div>
        {% endif %}
    </section>

</div>

{% endblock %}